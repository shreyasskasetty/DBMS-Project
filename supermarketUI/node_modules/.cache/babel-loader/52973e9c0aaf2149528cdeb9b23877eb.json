{"ast":null,"code":"import _objectSpread from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/shreyas/DBMS-Project/supermarketUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/shreyas/DBMS-Project/supermarketUI/src/views/Index.jsx\";\n\n/*!\n\n=========================================================\n* Argon Dashboard React - v1.0.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/\nimport React from \"react\";\nimport firebase from '../config/fbConfig'; // node.js library that concatenates classes (strings)\n\nimport classnames from \"classnames\"; // javascipt plugin for creating charts\n\nimport Chart from \"chart.js\"; // react plugin used to create charts\n\nimport { Line, Bar } from \"react-chartjs-2\"; // reactstrap components\n\nimport { Button, Card, CardHeader, CardBody, NavItem, NavLink, Nav, Progress, Table, Container, Row, Col } from \"reactstrap\"; // core components\n\nimport { chartOptions, parseOptions, chartExample1 } from \"variables/charts.jsx\";\nimport Header from \"components/Headers/Header.jsx\";\nimport { func } from 'prop-types';\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n    _this.state = {\n      activeNav: 1,\n      chartExample1Data: \"data1\",\n      chartExampl: {\n        options: {\n          scales: {\n            yAxes: [{\n              ticks: {\n                callback: function callback(value) {\n                  if (!(value % 10)) {\n                    //return '$' + value + 'k'\n                    return value;\n                  }\n                }\n              }\n            }]\n          },\n          tooltips: {\n            callbacks: {\n              label: function label(item, data) {\n                var label = data.datasets[item.datasetIndex].label || \"\";\n                var yLabel = item.yLabel;\n                var content = \"\";\n\n                if (data.datasets.length > 1) {\n                  content += label;\n                }\n\n                content += yLabel;\n                return content;\n              }\n            }\n          }\n        },\n        data: {\n          labels: [],\n          datasets: [{\n            label: \"Sales\",\n            data: []\n          }]\n        }\n      },\n      chartExampl1: {\n        options: {\n          scales: {\n            yAxes: [{\n              ticks: {\n                callback: function callback(value) {\n                  if (!(value % 10)) {\n                    //return '$' + value + 'k'\n                    return value;\n                  }\n                }\n              }\n            }]\n          },\n          tooltips: {\n            callbacks: {\n              label: function label(item, data) {\n                var label = data.datasets[item.datasetIndex].label || \"\";\n                var yLabel = item.yLabel;\n                var content = \"\";\n\n                if (data.datasets.length > 1) {\n                  content += label;\n                }\n\n                content += yLabel;\n                return content;\n              }\n            }\n          }\n        },\n        data: {\n          labels: [],\n          datasets: [{\n            label: \"Sales\",\n            data: []\n          }]\n        }\n      },\n      cusData: []\n    };\n\n    _this.writeDiscount = function (sec, id) {\n      fetch(\"/getSec\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          section: sec,\n          cid: id\n        })\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === true) {\n          console.log(data);\n          var db = firebase.firestore();\n          var ref = db.collection('Discount').doc(id);\n          data.rows.forEach(function (item) {\n            ref.update({\n              pid: firebase.firestore.FieldValue.arrayUnion(item)\n            });\n          });\n        } else if (data.status === false) {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.mailOffer = function (sec, id) {\n      fetch(\"/secProds\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          section: sec,\n          cid: id\n        })\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === true) {\n          alert('offer sent');\n        } else if (data.status === false) {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.handleClick = function (e) {\n      e.preventDefault();\n      var id = e.currentTarget.dataset.id;\n\n      var setX = function setX(dat) {\n        var labels1 = [];\n        var qu1 = [];\n\n        for (var i = 0; i < dat.length; i++) {\n          labels1.push(dat[i].pid);\n          qu1.push(dat[i].sq);\n        }\n\n        var temChat = _this.state.chartExampl1;\n        temChat.data.labels = labels1;\n        temChat.data.datasets.push({\n          label: \"sales\",\n          data: qu1\n        });\n\n        _this.setState(_objectSpread({}, _this.state, {\n          chartExampl1: temChat\n        }));\n      };\n\n      fetch(\"/cusAnalysis\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          cid: id\n        })\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === true) {\n          setX(data.data);\n        } else if (data.status === false) {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n      fetch(\"/analysis\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          cid: id\n        })\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === true) {\n          alert('Analysis Completed');\n        } else if (data.status === false) {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n      var db = firebase.firestore();\n      db.collection(\"Results\").onSnapshot(function (snap) {\n        var changes = snap.docChanges();\n        changes.forEach(function (change) {\n          var data = change.doc.data();\n          data.id = change.doc.id;\n\n          if (change.type === 'added') {\n            if (data.x < 120) {\n              _this.mailOffer('secA', id);\n\n              _this.writeDiscount('secA', id);\n            }\n\n            if (data.x >= 120 && data.x < 200) {\n              _this.mailOffer('secB', id);\n\n              _this.writeDiscount('secB', id);\n            }\n\n            if (data.x >= 200) {\n              _this.mailOffer('secC', id);\n\n              _this.writeDiscount('secC', id); //db.collection('Results').doc(data.id).delete();\n\n            }\n          } else if (change.type === 'removed') console.log(data);\n        });\n      });\n    };\n\n    _this.dispTable = function () {\n      var list = _this.state.cusData;\n\n      if (list.length !== 0) {\n        return list.map(function (data, key) {\n          return React.createElement(\"tr\", {\n            key: data.cid,\n            \"data-id\": data.cid,\n            value: data.cid,\n            onClick: _this.handleClick,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 400\n            },\n            __self: this\n          }, React.createElement(\"th\", {\n            scope: \"row\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 401\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            id: data.cid,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 401\n            },\n            __self: this\n          }, \" \", data.name)), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 402\n            },\n            __self: this\n          }, data.sq), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 403\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            className: \"col text-right\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 404\n            },\n            __self: this\n          }, React.createElement(Button, {\n            color: \"primary\",\n            size: \"sm\",\n            value: data.cid,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 405\n            },\n            __self: this\n          }, \"Analyse\"))));\n        });\n      } else return null;\n    };\n\n    _this.dispTable = _this.dispTable.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var setP = function setP(dat) {\n        console.log('chnages');\n        var labels = [];\n        var qu = [];\n\n        for (var i = 0; i < dat.length; i++) {\n          labels.push(dat[i].name);\n          qu.push(dat[i].sq);\n        }\n\n        var temChat = _this2.state.chartExampl;\n        temChat.data.labels = labels;\n        temChat.data.datasets.push({\n          label: \"sales\",\n          data: qu\n        });\n\n        _this2.setState(_objectSpread({}, _this2.state, {\n          chartExampl: temChat\n        }));\n      };\n\n      var setC = function setC(data) {\n        _this2.setState(_objectSpread({}, _this2.state, {\n          cusData: data\n        }));\n      };\n\n      fetch(\"/chartData\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: null\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === \"success\") {\n          setP(data.rows);\n        } else if (data.status === \"failure\") {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n      fetch(\"/cusData\", {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: null\n      }).then(function (response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n\n        return response.json();\n      }).then(function (data) {\n        if (data.status === \"success\") {\n          setC(data.rows);\n        } else if (data.status === \"failure\") {\n          console.log(data.message);\n          alert(data.message);\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      if (window.Chart) {\n        parseOptions(Chart, chartOptions());\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(React.Fragment, null, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }), React.createElement(Container, {\n        className: \"mt--7\",\n        fluid: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 434\n        },\n        __self: this\n      }, React.createElement(Col, {\n        className: \"mb-5 mb-xl-0\",\n        xl: \"8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 435\n        },\n        __self: this\n      }, React.createElement(Card, {\n        className: \"shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        className: \"border-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }, React.createElement(Row, {\n        className: \"align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 438\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 439\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440\n        },\n        __self: this\n      }, \"Customer visits\")))), React.createElement(Table, {\n        className: \"align-items-center table-flush\",\n        responsive: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        className: \"thead-light\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 447\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 449\n        },\n        __self: this\n      }, \"Customer name\"), React.createElement(\"th\", {\n        scope: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450\n        },\n        __self: this\n      }, \"Visits\"))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 455\n        },\n        __self: this\n      }, this.dispTable())))), React.createElement(Col, {\n        xl: \"4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 466\n        },\n        __self: this\n      }, React.createElement(Card, {\n        className: \"shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 467\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        className: \"bg-transparent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 468\n        },\n        __self: this\n      }, React.createElement(Row, {\n        className: \"align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 469\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 470\n        },\n        __self: this\n      }, React.createElement(\"h6\", {\n        className: \"text-uppercase text-muted ls-1 mb-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 471\n        },\n        __self: this\n      }, \"Performance\"), React.createElement(\"h2\", {\n        className: \"mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 474\n        },\n        __self: this\n      }, \"Total orders\")))), React.createElement(CardBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"chart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481\n        },\n        __self: this\n      }, React.createElement(Bar, {\n        data: this.state.chartExampl.data,\n        options: this.state.chartExampl.options,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 482\n        },\n        __self: this\n      })))))), React.createElement(Row, {\n        className: \"mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 491\n        },\n        __self: this\n      }, React.createElement(Col, {\n        xl: \"4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492\n        },\n        __self: this\n      }, React.createElement(Card, {\n        className: \"shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 493\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        className: \"bg-transparent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 494\n        },\n        __self: this\n      }, React.createElement(Row, {\n        className: \"align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 495\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 496\n        },\n        __self: this\n      }, React.createElement(\"h6\", {\n        className: \"text-uppercase text-muted ls-1 mb-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 497\n        },\n        __self: this\n      }, \"Customer\"), React.createElement(\"h2\", {\n        className: \"mb-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 500\n        },\n        __self: this\n      }, \"Total orders\")))), React.createElement(CardBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"chart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506\n        },\n        __self: this\n      }, React.createElement(Bar, {\n        data: this.state.chartExampl1.data,\n        options: this.state.chartExampl1.options,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }))))), React.createElement(Col, {\n        xl: \"4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 516\n        },\n        __self: this\n      }, React.createElement(Card, {\n        className: \"shadow\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        className: \"bg-transparent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 518\n        },\n        __self: this\n      }, React.createElement(Row, {\n        className: \"align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 519\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 520\n        },\n        __self: this\n      }, React.createElement(\"h6\", {\n        className: \"text-uppercase text-muted ls-1 mb-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 521\n        },\n        __self: this\n      }, \"Heat Map\")))), React.createElement(CardBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 528\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"chart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 529\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: \"home/shreyas/DBMS-Project/supermarketUI/src/assets/img/gaphs/img.jpg\",\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 530\n        },\n        __self: this\n      }))))))));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default Index;","map":{"version":3,"sources":["/home/shreyas/DBMS-Project/supermarketUI/src/views/Index.jsx"],"names":["React","firebase","classnames","Chart","Line","Bar","Button","Card","CardHeader","CardBody","NavItem","NavLink","Nav","Progress","Table","Container","Row","Col","chartOptions","parseOptions","chartExample1","Header","func","Index","props","state","activeNav","chartExample1Data","chartExampl","options","scales","yAxes","ticks","callback","value","tooltips","callbacks","label","item","data","datasets","datasetIndex","yLabel","content","length","labels","chartExampl1","cusData","writeDiscount","sec","id","fetch","method","headers","body","JSON","stringify","section","cid","then","response","status","Error","json","console","log","db","firestore","ref","collection","doc","rows","forEach","update","pid","FieldValue","arrayUnion","message","alert","catch","err","mailOffer","handleClick","e","preventDefault","currentTarget","dataset","setX","dat","labels1","qu1","i","push","sq","temChat","setState","onSnapshot","snap","changes","docChanges","change","type","x","dispTable","list","map","key","name","bind","setP","qu","setC","window","Component"],"mappings":"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","sourcesContent":["/*!\n\n=========================================================\n* Argon Dashboard React - v1.0.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/\nimport React from \"react\";\nimport firebase from '../config/fbConfig'\n\n// node.js library that concatenates classes (strings)\nimport classnames from \"classnames\";\n// javascipt plugin for creating charts\nimport Chart from \"chart.js\";\n// react plugin used to create charts\nimport { Line, Bar } from \"react-chartjs-2\";\n// reactstrap components\nimport {\n  Button,\n  Card,\n  CardHeader,\n  CardBody,\n  NavItem,\n  NavLink,\n  Nav,\n  Progress,\n  Table,\n  Container,\n  Row,\n  Col\n} from \"reactstrap\";\n\n// core components\nimport {\n  chartOptions,\n  parseOptions,\n  chartExample1,\n} from \"variables/charts.jsx\";\n\nimport Header from \"components/Headers/Header.jsx\";\nimport { func } from 'prop-types';\n\nclass Index extends React.Component {\n  constructor(props){\n    super(props)\n    this.dispTable = this.dispTable.bind(this )\n  }\n  state = {\n    activeNav: 1,\n    chartExample1Data: \"data1\",\n    chartExampl : {\n      options: {\n        scales: {\n          yAxes: [\n            {\n              ticks: {\n                callback: function(value) {\n                  if (!(value % 10)) {\n                    //return '$' + value + 'k'\n                    return value;\n                  }\n                }\n              }\n            }\n          ]\n        },\n        tooltips: {\n          callbacks: {\n            label: function(item, data) {\n              var label = data.datasets[item.datasetIndex].label || \"\";\n              var yLabel = item.yLabel;\n              var content = \"\";\n              if (data.datasets.length > 1) {\n                content += label;\n              }\n              content += yLabel;\n              return content;\n            }\n          }\n        }\n      },\n      data: {\n        labels: [],\n        datasets: [\n          {\n            label: \"Sales\",\n            data: []\n          }\n        ]\n      }\n    },\n    chartExampl1 : {\n      options: {\n        scales: {\n          yAxes: [\n            {\n              ticks: {\n                callback: function(value) {\n                  if (!(value % 10)) {\n                    //return '$' + value + 'k'\n                    return value;\n                  }\n                }\n              }\n            }\n          ]\n        },\n        tooltips: {\n          callbacks: {\n            label: function(item, data) {\n              var label = data.datasets[item.datasetIndex].label || \"\";\n              var yLabel = item.yLabel;\n              var content = \"\";\n              if (data.datasets.length > 1) {\n                content += label;\n              }\n              content += yLabel;\n              return content;\n            }\n          }\n        }\n      },\n      data: {\n        labels: [],\n        datasets: [\n          {\n            label: \"Sales\",\n            data: []\n          }\n        ]\n      }\n    },\n    cusData:[]\n  };\n\n  componentDidMount(){\n    const setP= (dat)=>{\n      console.log('chnages')\n      var labels = []\n      var qu = []\n      for (let i=0; i< dat.length;i++)\n      {\n        labels.push(dat[i].name)\n        qu.push(dat[i].sq)\n      }\n      var temChat = this.state.chartExampl\n      temChat.data.labels = labels\n      temChat.data.datasets.push({label: \"sales\", data : qu})\n      this.setState({\n          ...this.state,\n          chartExampl : temChat\n      })\n    }\n\n    const setC = (data)=>{\n      this.setState({\n        ...this.state,\n        cusData : data\n      })\n    }\n    fetch(\"/chartData\", {\n      method: 'POST',\n      headers: {\n      'Content-Type': 'application/json'},\n      body: null\n      })\n      .then(function(response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n        return response.json();\n      })\n      .then(function(data){         \n        if (data.status === \"success\")\n        {\n          setP(data.rows)\n        }\n        else if (data.status === \"failure\")\n        {          \n          console.log(data.message)\n          alert(data.message)\n        }\n      }).catch(function(err) {\n      console.log(err)\n      });\n\n      fetch(\"/cusData\", {\n        method: 'POST',\n        headers: {\n        'Content-Type': 'application/json'},\n        body: null\n        })\n        .then(function(response) {\n          if (response.status >= 400) {\n            throw new Error(\"Bad response from server\");\n          }\n          return response.json();\n        })\n        .then(function(data){         \n          if (data.status === \"success\")\n          {\n            setC(data.rows)\n          }\n          else if (data.status === \"failure\")\n          {\n            console.log(data.message)\n            alert(data.message)\n          }\n        }).catch(function(err) {\n        console.log(err)\n        });\n      \n      \n  }\n  writeDiscount = (sec,id)=>{\n    fetch(\"/getSec\", {\n      method: 'POST',\n      headers: {\n      'Content-Type': 'application/json'},\n      body: JSON.stringify({section:sec,cid:id})\n      })\n      .then(function(response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n        return response.json();\n      })\n      .then(function(data){\n        if (data.status === true)\n        {\n          console.log(data)\n          const db = firebase.firestore();\n          var ref = db.collection('Discount').doc(id);\n          data.rows.forEach((item) => {\n            ref.update({\n              pid : firebase.firestore.FieldValue.arrayUnion(item)\n            })\n          })\n        }\n        else if (data.status === false)\n        {\n          console.log(data.message)\n          alert(data.message)\n        }\n      }).catch(function(err) {\n      console.log(err)\n      });\n  }\n\n  mailOffer=(sec,id)=>{\n    fetch(\"/secProds\", {\n      method: 'POST',\n      headers: {\n      'Content-Type': 'application/json'},\n      body: JSON.stringify({section:sec,cid:id})\n      })\n      .then(function(response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n        return response.json();\n      })\n      .then(function(data){\n        if (data.status === true)\n        {\n          alert('offer sent')\n        }\n        else if (data.status === false)\n        {\n          console.log(data.message)\n          alert(data.message)\n        }\n      }).catch(function(err) {\n      console.log(err)\n      });\n  }\n  handleClick = (e)=>{\n    e.preventDefault()\n    var id = e.currentTarget.dataset.id\n    const setX= (dat)=>{\n      var labels1 = []\n      var qu1 = []\n      for (let i=0; i< dat.length;i++)\n      {\n        labels1.push(dat[i].pid)\n        qu1.push(dat[i].sq)\n      }\n      var temChat = this.state.chartExampl1\n      temChat.data.labels = labels1\n      temChat.data.datasets.push({label: \"sales\", data : qu1})\n      this.setState({\n          ...this.state,\n          chartExampl1 : temChat\n      })\n    }\n    \n    fetch(\"/cusAnalysis\", {\n      method: 'POST',\n      headers: {\n      'Content-Type': 'application/json'},\n      body: JSON.stringify({cid : id})\n      })\n      .then(function(response) {\n        if (response.status >= 400) {\n          throw new Error(\"Bad response from server\");\n        }\n        return response.json();\n      })\n      .then(function(data){\n        if (data.status === true)\n        {\n          setX(data.data)\n        }\n        else if (data.status === false)\n        {\n          console.log(data.message)\n          alert(data.message)\n        }\n      }).catch(function(err) {\n      console.log(err)\n      });\n      \n      fetch(\"/analysis\", {\n        method: 'POST',\n        headers: {\n        'Content-Type': 'application/json'},\n        body: JSON.stringify({cid : id})\n        })\n        .then(function(response) {\n          if (response.status >= 400) {\n            throw new Error(\"Bad response from server\");\n          }\n          return response.json();\n        })\n        .then(function(data){\n          if (data.status === true)\n          {\n            alert('Analysis Completed')\n          }\n          else if (data.status === false)\n          {\n            console.log(data.message)\n            alert(data.message)\n          }\n        }).catch(function(err) {\n        console.log(err)\n        });\n        const db = firebase.firestore();\n\n        db.collection(\"Results\")\n    .onSnapshot((snap) => {\n      const changes = snap.docChanges();\n    \n      changes.forEach((change) =>{\n      const data = change.doc.data()\n      data.id = change.doc.id\n      if (change.type === 'added')\n       { \n        if (data.x < 120 )\n        {\n          this.mailOffer('secA',id)\n          this.writeDiscount('secA',id)\n        \n         } if (data.x >= 120 && data.x < 200)\n        {this.mailOffer('secB',id)\n        this.writeDiscount('secB',id)\n\n        }if (data.x >= 200)\n        {this.mailOffer('secC',id)\n        this.writeDiscount('secC',id)\n\n      //db.collection('Results').doc(data.id).delete();\n      }\n      }\n\n      else if (change.type === 'removed')\n        console.log(data)\n      })\n    })\n  }\n\n\n  dispTable = ()=>{\n    var list = this.state.cusData\n    if (list.length !== 0)\n    {\n      return(\n        list.map((data,key)=>{\n          return(\n            <tr key = {data.cid} data-id= {data.cid} value={data.cid} onClick={this.handleClick}>\n                      <th scope=\"row\"  ><div id = {data.cid}> {data.name}</div></th>\n                      <td>{data.sq}</td>\n                      <td>\n                      <div className=\"col text-right\">\n                      <Button\n                        color=\"primary\"\n                        size=\"sm\"\n                        value = {data.cid}\n                      >\n                        Analyse\n                      </Button>\n                    </div>\n                      </td>\n                     \n                    </tr>\n          )\n        })\n      )\n    }\n    else return null\n  }\n\n  componentWillMount() {\n    if (window.Chart) {\n      parseOptions(Chart, chartOptions());\n    }\n  }\n  render() {\n    return (\n      <>\n        <Header />\n        {/* Page content */}\n        <Container className=\"mt--7\" fluid>\n          <Row>\n          <Col className=\"mb-5 mb-xl-0\" xl=\"8\">\n              <Card className=\"shadow\">\n                <CardHeader className=\"border-0\">\n                  <Row className=\"align-items-center\">\n                    <div className=\"col\">\n                      <h3 className=\"mb-0\">Customer visits</h3>\n                    </div>\n                    \n                  </Row>\n                </CardHeader>\n\n                <Table className=\"align-items-center table-flush\" responsive>\n                  <thead className=\"thead-light\">\n                    <tr>\n                      <th scope=\"col\">Customer name</th>\n                      <th scope=\"col\">Visits</th>\n                     \n                    </tr>\n                   \n                  </thead>\n                  <tbody>\n                    {this.dispTable()}\n\n                  </tbody>\n                </Table>\n              </Card>\n            </Col>\n\n            \n\n            {/*Total Sales */}\n            <Col xl=\"4\">\n              <Card className=\"shadow\">\n                <CardHeader className=\"bg-transparent\">\n                  <Row className=\"align-items-center\">\n                    <div className=\"col\">\n                      <h6 className=\"text-uppercase text-muted ls-1 mb-1\">\n                        Performance\n                      </h6>\n                      <h2 className=\"mb-0\">Total orders</h2>\n                    </div>\n                  </Row>\n                </CardHeader>\n               \n                <CardBody>\n                  {/* Chart */}\n                  <div className=\"chart\">\n                    <Bar\n                      data={this.state.chartExampl.data}\n                      options={this.state.chartExampl.options}\n                    />\n                  </div>\n                </CardBody>\n              </Card>\n            </Col>\n          </Row>\n          <Row className=\"mt-5\">\n            <Col xl=\"4\"> \n            <Card className=\"shadow\">\n                <CardHeader className=\"bg-transparent\">\n                  <Row className=\"align-items-center\">\n                    <div className=\"col\">\n                      <h6 className=\"text-uppercase text-muted ls-1 mb-1\">\n                        Customer\n                      </h6>\n                      <h2 className=\"mb-0\">Total orders</h2>\n                    </div>\n                  </Row>\n                </CardHeader>\n               \n                <CardBody>\n                  <div className=\"chart\">\n                    <Bar\n                      data={this.state.chartExampl1.data}\n                      options={this.state.chartExampl1.options}\n                    />\n                  </div>\n                </CardBody>\n                </Card>\n                \n            </Col> \n            <Col xl=\"4\"> \n            <Card className=\"shadow\">\n                <CardHeader className=\"bg-transparent\">\n                  <Row className=\"align-items-center\">\n                    <div className=\"col\">\n                      <h6 className=\"text-uppercase text-muted ls-1 mb-1\">\n                        Heat Map\n                      </h6>\n                    </div>\n                  </Row>\n                </CardHeader>\n               \n                <CardBody>\n                  <div className=\"chart\">\n                    <img src=\"home/shreyas/DBMS-Project/supermarketUI/src/assets/img/gaphs/img.jpg\" alt=\"\"/>\n                  </div>\n                </CardBody>\n                </Card>\n                \n            </Col> \n          </Row>\n        </Container>\n      </>\n    );\n  }\n}\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}